<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : GameLogics
Description : This module provides a basic set of rules to define connect four game.

Module defines all types and functions needed to store and manipulate gamestate. These functions are used in both Server and MCTS modules to define possible continuation of the current game or state in which the game has ended. 
-}</span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GameLogics</span><span class="hs-special">(</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier">Player</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier">Board</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="GameLogics.html#Result"><span class="hs-identifier">Result</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="GameLogics.html#Position"><span class="hs-identifier">Position</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="GameLogics.html#newGame"><span class="hs-identifier">newGame</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="GameLogics.html#makeMove"><span class="hs-identifier">makeMove</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="GameLogics.html#legalMoves"><span class="hs-identifier">legalMoves</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="GameLogics.html#evaluatePosition"><span class="hs-identifier">evaluatePosition</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="GameLogics.html#boardToString"><span class="hs-identifier">boardToString</span></a></span><span>
</span><span id="line-17"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-comment">-- | Players : R - Red, Y - Yellow. Red one starts the game.</span><span>
</span><span id="line-22"></span><span class="hs-keyword">data</span><span> </span><span id="Player"><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-var">Player</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="R"><span class="annot"><a href="GameLogics.html#R"><span class="hs-identifier hs-var">R</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Y"><span class="annot"><a href="GameLogics.html#Y"><span class="hs-identifier hs-var">Y</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059001"><span id="local-6989586621679059003"><span id="local-6989586621679059005"><span class="annot"><span class="annottext">Int -&gt; Player -&gt; ShowS
[Player] -&gt; ShowS
Player -&gt; String
(Int -&gt; Player -&gt; ShowS)
-&gt; (Player -&gt; String) -&gt; ([Player] -&gt; ShowS) -&gt; Show Player
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Player] -&gt; ShowS
$cshowList :: [Player] -&gt; ShowS
show :: Player -&gt; String
$cshow :: Player -&gt; String
showsPrec :: Int -&gt; Player -&gt; ShowS
$cshowsPrec :: Int -&gt; Player -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058996"><span id="local-6989586621679058998"><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
(Player -&gt; Player -&gt; Bool)
-&gt; (Player -&gt; Player -&gt; Bool) -&gt; Eq Player
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Player -&gt; Player -&gt; Bool
$c/= :: Player -&gt; Player -&gt; Bool
== :: Player -&gt; Player -&gt; Bool
$c== :: Player -&gt; Player -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058987"><span id="local-6989586621679058989"><span id="local-6989586621679058991"><span id="local-6989586621679058993"><span class="annot"><span class="annottext">ReadPrec [Player]
ReadPrec Player
Int -&gt; ReadS Player
ReadS [Player]
(Int -&gt; ReadS Player)
-&gt; ReadS [Player]
-&gt; ReadPrec Player
-&gt; ReadPrec [Player]
-&gt; Read Player
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Player]
$creadListPrec :: ReadPrec [Player]
readPrec :: ReadPrec Player
$creadPrec :: ReadPrec Player
readList :: ReadS [Player]
$creadList :: ReadS [Player]
readsPrec :: Int -&gt; ReadS Player
$creadsPrec :: Int -&gt; ReadS Player
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">-- | Current state of the game - every column is described as stack of players' tokens. </span><span>
</span><span id="line-25"></span><span class="hs-keyword">type</span><span> </span><span id="Board"><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier hs-var">Board</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- | Result of the game.</span><span>
</span><span id="line-28"></span><span class="hs-keyword">data</span><span> </span><span id="Result"><span class="annot"><a href="GameLogics.html#Result"><span class="hs-identifier hs-var">Result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Win"><span class="annot"><a href="GameLogics.html#Win"><span class="hs-identifier hs-var">Win</span></a></span></span><span> </span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Draw"><span class="annot"><a href="GameLogics.html#Draw"><span class="hs-identifier hs-var">Draw</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="InProgress"><span class="annot"><a href="GameLogics.html#InProgress"><span class="hs-identifier hs-var">InProgress</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058977"><span id="local-6989586621679058979"><span id="local-6989586621679058981"><span class="annot"><span class="annottext">Int -&gt; Result -&gt; ShowS
[Result] -&gt; ShowS
Result -&gt; String
(Int -&gt; Result -&gt; ShowS)
-&gt; (Result -&gt; String) -&gt; ([Result] -&gt; ShowS) -&gt; Show Result
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Result] -&gt; ShowS
$cshowList :: [Result] -&gt; ShowS
show :: Result -&gt; String
$cshow :: Result -&gt; String
showsPrec :: Int -&gt; Result -&gt; ShowS
$cshowsPrec :: Int -&gt; Result -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058973"><span id="local-6989586621679058975"><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Bool
(Result -&gt; Result -&gt; Bool)
-&gt; (Result -&gt; Result -&gt; Bool) -&gt; Eq Result
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Result -&gt; Result -&gt; Bool
$c/= :: Result -&gt; Result -&gt; Bool
== :: Result -&gt; Result -&gt; Bool
$c== :: Result -&gt; Result -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | Position is a wrapper for board type, so it is possible to get player whose current turn it is without counting tokens on board.</span><span>
</span><span id="line-31"></span><span class="hs-keyword">data</span><span> </span><span id="Position"><span class="annot"><a href="GameLogics.html#Position"><span class="hs-identifier hs-var">Position</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Position"><span class="annot"><a href="GameLogics.html#Position"><span class="hs-identifier hs-var">Position</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-32"></span><span>    </span><span id="turn"><span class="annot"><span class="annottext">Position -&gt; Player
</span><a href="GameLogics.html#turn"><span class="hs-identifier hs-var hs-var">turn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span id="board"><span class="annot"><span class="annottext">Position -&gt; Board
</span><a href="GameLogics.html#board"><span class="hs-identifier hs-var hs-var">board</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier hs-type">Board</span></a></span><span>
</span><span id="line-34"></span><span class="hs-special">}</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679058965"><span id="local-6989586621679058968"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="GameLogics.html#Position"><span class="hs-identifier hs-type">Position</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>    </span><span id="local-6989586621679058964"><span class="annot"><span class="annottext">show :: Position -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span id="local-6989586621679058962"><span class="annot"><span class="annottext">pos :: Position
</span><a href="#local-6989586621679058962"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Board -&gt; String
</span><a href="GameLogics.html#boardToString"><span class="hs-identifier hs-var">boardToString</span></a></span><span> </span><span class="annot"><span class="annottext">(Board -&gt; String) -&gt; Board -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Board
</span><a href="GameLogics.html#board"><span class="hs-identifier hs-var hs-var">board</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679058962"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | User-friendly view of board.</span><span>
</span><span id="line-40"></span><span class="annot"><a href="GameLogics.html#boardToString"><span class="hs-identifier hs-type">boardToString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier hs-type">Board</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-41"></span><span id="boardToString"><span class="annot"><span class="annottext">boardToString :: Board -&gt; String
</span><a href="GameLogics.html#boardToString"><span class="hs-identifier hs-var hs-var">boardToString</span></a></span></span><span> </span><span id="local-6989586621679058961"><span class="annot"><span class="annottext">b :: Board
</span><a href="#local-6989586621679058961"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall a. [[a]] -&gt; [[a]]
</span><span class="hs-identifier hs-var">transpose</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Player] -&gt; String) -&gt; Board -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679058958"><span class="annot"><span class="annottext">c :: [Player]
</span><a href="#local-6989586621679058958"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[Player] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Player]
</span><a href="#local-6989586621679058958"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-char">'#'</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Player -&gt; String) -&gt; [Player] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Player -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[Player]
</span><a href="#local-6989586621679058958"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058961"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | Creates new game with zero tokens and Red's turn.</span><span>
</span><span id="line-44"></span><span class="annot"><a href="GameLogics.html#newGame"><span class="hs-identifier hs-type">newGame</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span>
</span><span id="line-45"></span><span id="newGame"><span class="annot"><span class="annottext">newGame :: Position
</span><a href="GameLogics.html#newGame"><span class="hs-identifier hs-var hs-var">newGame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Player -&gt; Board -&gt; Position
</span><a href="GameLogics.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="GameLogics.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">(Board -&gt; Position) -&gt; Board -&gt; Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Player] -&gt; Board
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="hs-number">7</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- | Adds token to a specified column and changes turn.</span><span>
</span><span id="line-48"></span><span class="annot"><a href="GameLogics.html#makeMove"><span class="hs-identifier hs-type">makeMove</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ number of column to put token in</span><span>
</span><span id="line-49"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameLogics.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-comment">-- ^ start postion</span><span>
</span><span id="line-50"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameLogics.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-comment">-- ^ position after move</span><span>
</span><span id="line-51"></span><span id="makeMove"><span class="annot"><span class="annottext">makeMove :: Int -&gt; Position -&gt; Position
</span><a href="GameLogics.html#makeMove"><span class="hs-identifier hs-var hs-var">makeMove</span></a></span></span><span> </span><span id="local-6989586621679058954"><span class="annot"><span class="annottext">col :: Int
</span><a href="#local-6989586621679058954"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameLogics.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span id="local-6989586621679058953"><span class="annot"><span class="annottext">turn :: Player
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">turn</span></a></span></span><span> </span><span id="local-6989586621679058952"><span class="annot"><span class="annottext">board :: Board
</span><a href="#local-6989586621679058952"><span class="hs-identifier hs-var">board</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Player -&gt; Board -&gt; Position
</span><a href="GameLogics.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; Player
</span><a href="#local-6989586621679058951"><span class="hs-identifier hs-var">reverseTurn</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">turn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Board -&gt; Board
</span><a href="#local-6989586621679058950"><span class="hs-identifier hs-var">addDisc</span></a></span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058952"><span class="hs-identifier hs-var">board</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><a href="#local-6989586621679058951"><span class="hs-identifier hs-type">reverseTurn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span>
</span><span id="line-54"></span><span>        </span><span id="local-6989586621679058951"><span class="annot"><span class="annottext">reverseTurn :: Player -&gt; Player
</span><a href="#local-6989586621679058951"><span class="hs-identifier hs-var hs-var">reverseTurn</span></a></span></span><span> </span><span class="annot"><a href="GameLogics.html#R"><span class="hs-identifier hs-type">R</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="GameLogics.html#Y"><span class="hs-identifier hs-var">Y</span></a></span><span>
</span><span id="line-55"></span><span>        </span><span class="annot"><a href="#local-6989586621679058951"><span class="hs-identifier hs-var">reverseTurn</span></a></span><span> </span><span class="annot"><a href="GameLogics.html#Y"><span class="hs-identifier hs-type">Y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="GameLogics.html#R"><span class="hs-identifier hs-var">R</span></a></span><span>
</span><span id="line-56"></span><span>        </span><span class="annot"><a href="#local-6989586621679058950"><span class="hs-identifier hs-type">addDisc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier hs-type">Board</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier hs-type">Board</span></a></span><span>
</span><span id="line-57"></span><span>        </span><span id="local-6989586621679058950"><span class="annot"><span class="annottext">addDisc :: Board -&gt; Board
</span><a href="#local-6989586621679058950"><span class="hs-identifier hs-var hs-var">addDisc</span></a></span></span><span> </span><span id="local-6989586621679058949"><span class="annot"><span class="annottext">board :: Board
</span><a href="#local-6989586621679058949"><span class="hs-identifier hs-var">board</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Player] -&gt; Int -&gt; [Player]) -&gt; Board -&gt; [Int] -&gt; Board
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679058947"><span class="annot"><span class="annottext">column :: [Player]
</span><a href="#local-6989586621679058947"><span class="hs-identifier hs-var">column</span></a></span></span><span> </span><span id="local-6989586621679058946"><span class="annot"><span class="annottext">index :: Int
</span><a href="#local-6989586621679058946"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058946"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058954"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">turn</span></a></span><span class="annot"><span class="annottext">Player -&gt; [Player] -&gt; [Player]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Player]
</span><a href="#local-6989586621679058947"><span class="hs-identifier hs-var">column</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Player]
</span><a href="#local-6989586621679058947"><span class="hs-identifier hs-var">column</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058949"><span class="hs-identifier hs-var">board</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Takes board and returns all numbers of columns where it is possible to put token.</span><span>
</span><span id="line-60"></span><span class="annot"><a href="GameLogics.html#legalMoves"><span class="hs-identifier hs-type">legalMoves</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier hs-type">Board</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span id="legalMoves"><span class="annot"><span class="annottext">legalMoves :: Board -&gt; [Int]
</span><a href="GameLogics.html#legalMoves"><span class="hs-identifier hs-var hs-var">legalMoves</span></a></span></span><span> </span><span id="local-6989586621679058945"><span class="annot"><span class="annottext">board :: Board
</span><a href="#local-6989586621679058945"><span class="hs-identifier hs-var">board</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Player], Int) -&gt; Int) -&gt; [([Player], Int)] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">([Player], Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([([Player], Int)] -&gt; [Int]) -&gt; [([Player], Int)] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(([Player], Int) -&gt; Bool) -&gt; [([Player], Int)] -&gt; [([Player], Int)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">6</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool)
-&gt; (([Player], Int) -&gt; Int) -&gt; ([Player], Int) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Player] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([Player] -&gt; Int)
-&gt; (([Player], Int) -&gt; [Player]) -&gt; ([Player], Int) -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([Player], Int) -&gt; [Player]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([([Player], Int)] -&gt; [([Player], Int)])
-&gt; [([Player], Int)] -&gt; [([Player], Int)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Board -&gt; [Int] -&gt; [([Player], Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058945"><span class="hs-identifier hs-var">board</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><a href="GameLogics.html#checkColumn"><span class="hs-identifier hs-type">checkColumn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-64"></span><span id="checkColumn"><span class="annot"><span class="annottext">checkColumn :: Player -&gt; [Player] -&gt; Bool
</span><a href="GameLogics.html#checkColumn"><span class="hs-identifier hs-var hs-var">checkColumn</span></a></span></span><span> </span><span id="local-6989586621679058941"><span class="annot"><span class="annottext">player :: Player
</span><a href="#local-6989586621679058941"><span class="hs-identifier hs-var">player</span></a></span></span><span> </span><span id="local-6989586621679058940"><span class="annot"><span class="annottext">column :: [Player]
</span><a href="#local-6989586621679058940"><span class="hs-identifier hs-var">column</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; Integer
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Integer, Integer)
</span><a href="#local-6989586621679058939"><span class="hs-identifier hs-var">longestSeq</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>        </span><span id="local-6989586621679058939"><span class="annot"><span class="annottext">longestSeq :: (Integer, Integer)
</span><a href="#local-6989586621679058939"><span class="hs-identifier hs-var hs-var">longestSeq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Integer, Integer) -&gt; Player -&gt; (Integer, Integer))
-&gt; (Integer, Integer) -&gt; [Player] -&gt; (Integer, Integer)
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; Player -&gt; (Integer, Integer)
forall b. (Ord b, Num b) =&gt; (b, b) -&gt; Player -&gt; (b, b)
</span><a href="#local-6989586621679058936"><span class="hs-identifier hs-var">longestSeqRec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Player]
</span><a href="#local-6989586621679058940"><span class="hs-identifier hs-var">column</span></a></span><span>
</span><span id="line-67"></span><span>        </span><span id="local-6989586621679058936"><span class="annot"><span class="annottext">longestSeqRec :: (b, b) -&gt; Player -&gt; (b, b)
</span><a href="#local-6989586621679058936"><span class="hs-identifier hs-var hs-var">longestSeqRec</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058935"><span class="annot"><span class="annottext">c :: b
</span><a href="#local-6989586621679058935"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058934"><span class="annot"><span class="annottext">m :: b
</span><a href="#local-6989586621679058934"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679058933"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679058933"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679058932"><span class="annot"><span class="annottext">n :: b
</span><a href="#local-6989586621679058932"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058933"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058941"><span class="hs-identifier hs-var">player</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679058935"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679058932"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679058932"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679058934"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><a href="GameLogics.html#checkColumns"><span class="hs-identifier hs-type">checkColumns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier hs-type">Board</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-70"></span><span id="checkColumns"><span class="annot"><span class="annottext">checkColumns :: Player -&gt; Board -&gt; Bool
</span><a href="GameLogics.html#checkColumns"><span class="hs-identifier hs-var hs-var">checkColumns</span></a></span></span><span> </span><span id="local-6989586621679058928"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679058928"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Player] -&gt; Bool) -&gt; Board -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Player -&gt; [Player] -&gt; Bool
</span><a href="GameLogics.html#checkColumn"><span class="hs-identifier hs-var">checkColumn</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058928"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><a href="GameLogics.html#checkRows"><span class="hs-identifier hs-type">checkRows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier hs-type">Board</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-73"></span><span id="checkRows"><span class="annot"><span class="annottext">checkRows :: Player -&gt; Board -&gt; Bool
</span><a href="GameLogics.html#checkRows"><span class="hs-identifier hs-var hs-var">checkRows</span></a></span></span><span> </span><span id="local-6989586621679058925"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679058925"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679058924"><span class="annot"><span class="annottext">b :: Board
</span><a href="#local-6989586621679058924"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-74"></span><span>                    </span><span id="local-6989586621679058922"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058922"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>                    </span><span id="local-6989586621679058921"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058921"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-number">6</span></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; [Bool]) -&gt; Bool -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679058919"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679058919"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Player -&gt; Board -&gt; Int -&gt; Int -&gt; Bool
</span><a href="GameLogics.html#checkTile"><span class="hs-identifier hs-var">checkTile</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058924"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058922"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058919"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058921"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">]</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><a href="GameLogics.html#checkDiagonals"><span class="hs-identifier hs-type">checkDiagonals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier hs-type">Board</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-79"></span><span id="checkDiagonals"><span class="annot"><span class="annottext">checkDiagonals :: Player -&gt; Board -&gt; Bool
</span><a href="GameLogics.html#checkDiagonals"><span class="hs-identifier hs-var hs-var">checkDiagonals</span></a></span></span><span> </span><span id="local-6989586621679058916"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679058916"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679058915"><span class="annot"><span class="annottext">b :: Board
</span><a href="#local-6989586621679058915"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-80"></span><span>                    </span><span id="local-6989586621679058914"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058914"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span>                    </span><span id="local-6989586621679058913"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058913"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; [Bool]) -&gt; Bool -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679058912"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679058912"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Player -&gt; Board -&gt; Int -&gt; Int -&gt; Bool
</span><a href="GameLogics.html#checkTile"><span class="hs-identifier hs-var">checkTile</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058916"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058915"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058914"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058912"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058913"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058912"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">]</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><a href="GameLogics.html#checkBoard"><span class="hs-identifier hs-type">checkBoard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier hs-type">Board</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-85"></span><span id="checkBoard"><span class="annot"><span class="annottext">checkBoard :: Player -&gt; Board -&gt; Bool
</span><a href="GameLogics.html#checkBoard"><span class="hs-identifier hs-var hs-var">checkBoard</span></a></span></span><span> </span><span id="local-6989586621679058910"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679058910"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679058909"><span class="annot"><span class="annottext">b :: Board
</span><a href="#local-6989586621679058909"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Player -&gt; Board -&gt; Bool
</span><a href="GameLogics.html#checkColumns"><span class="hs-identifier hs-var">checkColumns</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058910"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058909"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Board -&gt; Bool
</span><a href="GameLogics.html#checkRows"><span class="hs-identifier hs-var">checkRows</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058910"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058909"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Board -&gt; Bool
</span><a href="GameLogics.html#checkDiagonals"><span class="hs-identifier hs-var">checkDiagonals</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058910"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058909"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Player -&gt; Board -&gt; Bool
</span><a href="GameLogics.html#checkDiagonals"><span class="hs-identifier hs-var">checkDiagonals</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058910"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Board -&gt; Board
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058909"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="annot"><a href="GameLogics.html#checkTile"><span class="hs-identifier hs-type">checkTile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Player"><span class="hs-identifier hs-type">Player</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameLogics.html#Board"><span class="hs-identifier hs-type">Board</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-88"></span><span id="checkTile"><span class="annot"><span class="annottext">checkTile :: Player -&gt; Board -&gt; Int -&gt; Int -&gt; Bool
</span><a href="GameLogics.html#checkTile"><span class="hs-identifier hs-var hs-var">checkTile</span></a></span></span><span> </span><span id="local-6989586621679058906"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679058906"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679058905"><span class="annot"><span class="annottext">b :: Board
</span><a href="#local-6989586621679058905"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679058904"><span class="annot"><span class="annottext">x :: Int
</span><a href="#local-6989586621679058904"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679058903"><span class="annot"><span class="annottext">y :: Int
</span><a href="#local-6989586621679058903"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058903"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058902"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058905"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Board -&gt; Int -&gt; [Player]
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058904"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Player] -&gt; Int -&gt; Player
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058902"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058903"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Player -&gt; Player -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="#local-6989586621679058906"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>        </span><span id="local-6989586621679058902"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679058902"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Player] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058905"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Board -&gt; Int -&gt; [Player]
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058904"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- | Takes position and returns whether game has ended and if so, which result it had.</span><span>
</span><span id="line-95"></span><span class="annot"><a href="GameLogics.html#evaluatePosition"><span class="hs-identifier hs-type">evaluatePosition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameLogics.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameLogics.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-96"></span><span id="evaluatePosition"><span class="annot"><span class="annottext">evaluatePosition :: Position -&gt; Result
</span><a href="GameLogics.html#evaluatePosition"><span class="hs-identifier hs-var hs-var">evaluatePosition</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameLogics.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span id="local-6989586621679058900"><span class="annot"><span class="annottext">p :: Player
</span><a href="#local-6989586621679058900"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679058899"><span class="annot"><span class="annottext">b :: Board
</span><a href="#local-6989586621679058899"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Player -&gt; Board -&gt; Bool
</span><a href="GameLogics.html#checkBoard"><span class="hs-identifier hs-var">checkBoard</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="GameLogics.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058899"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Player -&gt; Result
</span><a href="GameLogics.html#Win"><span class="hs-identifier hs-var">Win</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="GameLogics.html#R"><span class="hs-identifier hs-var">R</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Player -&gt; Board -&gt; Bool
</span><a href="GameLogics.html#checkBoard"><span class="hs-identifier hs-var">checkBoard</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="GameLogics.html#Y"><span class="hs-identifier hs-var">Y</span></a></span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058899"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Player -&gt; Result
</span><a href="GameLogics.html#Win"><span class="hs-identifier hs-var">Win</span></a></span><span> </span><span class="annot"><span class="annottext">Player
</span><a href="GameLogics.html#Y"><span class="hs-identifier hs-var">Y</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Bool) -&gt; [Int] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Board -&gt; [Int]
</span><a href="GameLogics.html#legalMoves"><span class="hs-identifier hs-var">legalMoves</span></a></span><span> </span><span class="annot"><span class="annottext">Board
</span><a href="#local-6989586621679058899"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="GameLogics.html#Draw"><span class="hs-identifier hs-var">Draw</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="GameLogics.html#InProgress"><span class="hs-identifier hs-var">InProgress</span></a></span></pre></body></html>